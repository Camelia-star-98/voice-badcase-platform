# ðŸ”§ Supabase æ•°æ®åŒæ­¥ä¿®å¤æŒ‡å—

## ðŸ“‹ é—®é¢˜æè¿°

**é—®é¢˜çŽ°è±¡**ï¼š
- åœ¨ç”Ÿäº§çŽ¯å¢ƒï¼ˆhttps://voice-badcase-platform.vercel.app/status-flowï¼‰ç‚¹å‡»åˆ é™¤æŒ‰é’®åˆ é™¤æ•°æ®
- æ¢ä¸€å°ç”µè„‘è®¿é—®ï¼Œæ•°æ®è¿˜åœ¨

**æ ¹æœ¬åŽŸå› **ï¼š
- åº”ç”¨ä½¿ç”¨çš„æ˜¯ **localStorageï¼ˆæµè§ˆå™¨æœ¬åœ°å­˜å‚¨ï¼‰**ï¼Œä¸æ˜¯äº‘ç«¯æ•°æ®åº“
- æ¯å°ç”µè„‘çš„æµè§ˆå™¨éƒ½æœ‰è‡ªå·±çš„ localStorage
- åˆ é™¤æ“ä½œåªåœ¨å½“å‰æµè§ˆå™¨ç”Ÿæ•ˆï¼Œå…¶ä»–è®¾å¤‡ä¸åŒæ­¥

## âœ… è§£å†³æ–¹æ¡ˆ

å°†æ•°æ®å­˜å‚¨ä»Ž localStorage è¿ç§»åˆ° **Supabase äº‘æ•°æ®åº“**ï¼Œå®žçŽ°å¤šè®¾å¤‡æ•°æ®åŒæ­¥ã€‚

---

## ðŸš€ éƒ¨ç½²æ­¥éª¤

### ç¬¬ 1 æ­¥ï¼šæ‰§è¡Œæ•°æ®åº“è¿ç§»è„šæœ¬

1. **ç™»å½• Supabase**
   ```
   è®¿é—®: https://supabase.com/dashboard
   é€‰æ‹©é¡¹ç›®: bpivzznuvvbafsyvzxqm
   ```

2. **æ‰“å¼€ SQL Editor**
   - å·¦ä¾§èœå• â†’ **SQL Editor**
   - ç‚¹å‡» **New query**

3. **æ‰§è¡Œè¿ç§»è„šæœ¬**
   - æ‰“å¼€æ–‡ä»¶: `database/migrate_badcases_table.sql`
   - å¤åˆ¶å…¨éƒ¨å†…å®¹
   - ç²˜è´´åˆ° SQL Editor
   - ç‚¹å‡» **Run** æ‰§è¡Œ

4. **éªŒè¯ç»“æžœ**
   - å·¦ä¾§èœå• â†’ **Table Editor**
   - æŸ¥çœ‹ `badcases` è¡¨
   - ç¡®è®¤å­—æ®µåŒ…æ‹¬ï¼š
     - id, date, subject, category, description
     - location, full_tts_lesson_id, cms_id
     - reporter, expected_fix_date, status
     - audio_url, model_id
     - created_at, updated_at

---

### ç¬¬ 2 æ­¥ï¼šé…ç½®çŽ¯å¢ƒå˜é‡ï¼ˆVercelï¼‰

#### æ–¹æ³• Aï¼šé€šè¿‡ Vercel ç½‘é¡µæŽ§åˆ¶å°é…ç½®

1. **ç™»å½• Vercel**
   ```
   è®¿é—®: https://vercel.com/dashboard
   ```

2. **é€‰æ‹©é¡¹ç›®**
   - æ‰¾åˆ° `voice-badcase-platform` é¡¹ç›®
   - ç‚¹å‡»è¿›å…¥é¡¹ç›®è¯¦æƒ…

3. **æ·»åŠ çŽ¯å¢ƒå˜é‡**
   - ç‚¹å‡» **Settings** æ ‡ç­¾
   - å·¦ä¾§èœå•é€‰æ‹© **Environment Variables**
   - ç‚¹å‡» **Add New**

4. **æ·»åŠ ä»¥ä¸‹çŽ¯å¢ƒå˜é‡**ï¼š

   **å˜é‡ 1ï¼š**
   ```
   Name: VITE_SUPABASE_URL
   Value: https://bpivzznuvvbafsyvzxqm.supabase.co
   Environments: âœ… Production âœ… Preview âœ… Development
   ```

   **å˜é‡ 2ï¼š**
   ```
   Name: VITE_SUPABASE_ANON_KEY
   Value: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJwaXZ6em51dnZiYWZzeXZ6eHFtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzM0MDg1NjIsImV4cCI6MjA0ODk4NDU2Mn0.cXDE2rwda9N9o_eBSZeW10_YuVNCN6BCHc0kcNCuTRw
   Environments: âœ… Production âœ… Preview âœ… Development
   ```

5. **ä¿å­˜é…ç½®**
   - ç‚¹å‡» **Save**

#### æ–¹æ³• Bï¼šé€šè¿‡ Vercel CLI é…ç½®

```bash
# å®‰è£… Vercel CLIï¼ˆå¦‚æžœè¿˜æ²¡å®‰è£…ï¼‰
npm i -g vercel

# ç™»å½•
vercel login

# è¿›å…¥é¡¹ç›®ç›®å½•
cd /Users/ailian/Downloads/voice-badcase-platform

# æ·»åŠ çŽ¯å¢ƒå˜é‡
vercel env add VITE_SUPABASE_URL production
# è¾“å…¥å€¼: https://bpivzznuvvbafsyvzxqm.supabase.co

vercel env add VITE_SUPABASE_ANON_KEY production
# è¾“å…¥å¯†é’¥ï¼ˆè§ä¸Šæ–¹ï¼‰
```

---

### ç¬¬ 3 æ­¥ï¼šé‡æ–°éƒ¨ç½²

#### æ–¹æ³• Aï¼šè‡ªåŠ¨éƒ¨ç½²ï¼ˆæŽ¨èï¼‰

å¦‚æžœé¡¹ç›®è¿žæŽ¥äº† Git ä»“åº“ï¼š

```bash
# æäº¤æ›´æ–°çš„ä»£ç 
git add .
git commit -m "feat: ä½¿ç”¨ Supabase æ›¿ä»£ localStorageï¼Œå®žçŽ°å¤šè®¾å¤‡æ•°æ®åŒæ­¥"
git push origin main
```

Vercel ä¼šè‡ªåŠ¨æ£€æµ‹åˆ°æäº¤å¹¶é‡æ–°éƒ¨ç½²ã€‚

#### æ–¹æ³• Bï¼šæ‰‹åŠ¨éƒ¨ç½²

```bash
cd /Users/ailian/Downloads/voice-badcase-platform
vercel --prod
```

---

### ç¬¬ 4 æ­¥ï¼šéªŒè¯éƒ¨ç½²

1. **ç­‰å¾…éƒ¨ç½²å®Œæˆ**
   - åœ¨ Vercel æŽ§åˆ¶å°æŸ¥çœ‹éƒ¨ç½²çŠ¶æ€
   - ç­‰å¾…æ˜¾ç¤º **Ready**

2. **æ‰“å¼€ç”Ÿäº§çŽ¯å¢ƒ**
   ```
   https://voice-badcase-platform.vercel.app
   ```

3. **æ£€æŸ¥æµè§ˆå™¨æŽ§åˆ¶å°**
   - æŒ‰ F12 æ‰“å¼€å¼€å‘è€…å·¥å…·
   - åˆ‡æ¢åˆ° Console æ ‡ç­¾
   - åº”è¯¥çœ‹åˆ°ï¼š
     ```
     âœ… Supabase å®¢æˆ·ç«¯å·²åˆå§‹åŒ–
     ðŸŒ ä½¿ç”¨ Supabase æ•°æ®åº“
     âœ… ä»Ž Supabase åŠ è½½äº† X æ¡æ•°æ®
     ```

4. **æµ‹è¯•æ•°æ®åŒæ­¥**
   - åœ¨ç”µè„‘ A æ‰“å¼€åº”ç”¨ï¼Œåˆ é™¤ä¸€æ¡æ•°æ®
   - åœ¨ç”µè„‘ B åˆ·æ–°é¡µé¢
   - âœ… æ•°æ®åº”è¯¥åŒæ­¥æ¶ˆå¤±äº†ï¼

---

## ðŸ“Š æ–°ç³»ç»Ÿæž¶æž„

### æ•°æ®æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              ç”¨æˆ·æ“ä½œ                             â”‚
â”‚  (æ·»åŠ /æ›´æ–°/åˆ é™¤ Badcase)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         BadcaseContext                            â”‚
â”‚  (è‡ªåŠ¨æ£€æµ‹ Supabase æ˜¯å¦å¯ç”¨)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
       â”‚               â”‚
   æœ‰ Supabase?    æ— é…ç½®
       â”‚               â”‚
       â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Supabase   â”‚  â”‚  localStorageâ”‚
â”‚  äº‘æ•°æ®åº“   â”‚  â”‚  (é™çº§æ–¹æ¡ˆ)  â”‚
â”‚             â”‚  â”‚              â”‚
â”‚  âœ… å¤šè®¾å¤‡  â”‚  â”‚  âš ï¸ å•è®¾å¤‡   â”‚
â”‚  âœ… å®žæ—¶åŒæ­¥â”‚  â”‚  âš ï¸ æ— åŒæ­¥   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç‰¹æ€§

âœ… **è‡ªåŠ¨åˆ‡æ¢**
- å¦‚æžœ Supabase å¯ç”¨ â†’ ä½¿ç”¨äº‘æ•°æ®åº“
- å¦‚æžœè¿žæŽ¥å¤±è´¥ â†’ é™çº§åˆ° localStorage
- æ— éœ€æ‰‹åŠ¨é…ç½®

âœ… **å¤šè®¾å¤‡åŒæ­¥**
- æ‰€æœ‰æ“ä½œå®žæ—¶åŒæ­¥åˆ°äº‘ç«¯
- ä¸åŒç”µè„‘ã€ä¸åŒæµè§ˆå™¨çœ‹åˆ°ç›¸åŒæ•°æ®

âœ… **å‘åŽå…¼å®¹**
- æœ¬åœ°å¼€å‘ä»å¯ä½¿ç”¨ localStorage
- ä¸å½±å“çŽ°æœ‰åŠŸèƒ½

---

## ðŸ” æ•°æ®è¿ç§»ï¼ˆå¯é€‰ï¼‰

å¦‚æžœéœ€è¦å°† localStorage ä¸­çš„çŽ°æœ‰æ•°æ®è¿ç§»åˆ° Supabaseï¼š

### æ–¹æ³•ï¼šå¯¼å‡ºå¹¶å¯¼å…¥

1. **å¯¼å‡º localStorage æ•°æ®**
   - æ‰“å¼€æµè§ˆå™¨æŽ§åˆ¶å°ï¼ˆF12ï¼‰
   - è¾“å…¥ä»¥ä¸‹ä»£ç ï¼š
   ```javascript
   const data = localStorage.getItem('badcaseList');
   console.log(data);
   // å¤åˆ¶è¾“å‡ºçš„ JSON æ•°æ®
   ```

2. **è½¬æ¢ä¸º SQL æ’å…¥è¯­å¥**
   - ä½¿ç”¨åœ¨çº¿ JSON to SQL å·¥å…·
   - æˆ–æ‰‹åŠ¨ç¼–å†™ INSERT è¯­å¥

3. **åœ¨ Supabase SQL Editor ä¸­æ‰§è¡Œ**
   ```sql
   INSERT INTO public.badcases (
     id, date, subject, category, description, 
     location, cms_id, reporter, expected_fix_date, status
   ) VALUES
   ('BC-0001', '2024-12-20', 'chinese', 'è¯»éŸ³é”™è¯¯', 'é—®é¢˜æè¿°...', 'interactive', 'CMS-001', 'å¼ ä¸‰', '2024-12-31', 'pending'),
   -- æ›´å¤šæ•°æ®...
   ON CONFLICT (id) DO NOTHING;
   ```

---

## ðŸ†˜ æ•…éšœæŽ’æŸ¥

### é—®é¢˜ 1ï¼šæŽ§åˆ¶å°æ˜¾ç¤º "Supabase è¿žæŽ¥å¤±è´¥"

**åŽŸå› **ï¼šçŽ¯å¢ƒå˜é‡æœªæ­£ç¡®é…ç½®

**è§£å†³**ï¼š
1. æ£€æŸ¥ Vercel çŽ¯å¢ƒå˜é‡æ˜¯å¦æ·»åŠ æˆåŠŸ
2. ç¡®è®¤å˜é‡åæ‹¼å†™æ­£ç¡®ï¼ˆ`VITE_` å‰ç¼€å¿…é¡»æœ‰ï¼‰
3. é‡æ–°éƒ¨ç½²åº”ç”¨

### é—®é¢˜ 2ï¼šæ•°æ®ä»ç„¶ä¸åŒæ­¥

**åŽŸå› **ï¼šæµè§ˆå™¨ç¼“å­˜äº†æ—§ç‰ˆæœ¬åº”ç”¨

**è§£å†³**ï¼š
1. å¼ºåˆ¶åˆ·æ–°é¡µé¢ï¼šCtrl+Shift+R (Windows) æˆ– Cmd+Shift+R (Mac)
2. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜
3. ä½¿ç”¨éšç§/æ— ç—•æ¨¡å¼æµ‹è¯•

### é—®é¢˜ 3ï¼šåˆ é™¤æ“ä½œæŠ¥é”™

**åŽŸå› **ï¼šSupabase RLS ç­–ç•¥é™åˆ¶

**è§£å†³**ï¼š
1. æ£€æŸ¥æ•°æ®åº“ RLS ç­–ç•¥æ˜¯å¦å¯ç”¨
2. ç¡®è®¤è¿ç§»è„šæœ¬ä¸­çš„ç­–ç•¥å·²æ­£ç¡®åˆ›å»º
3. åœ¨ Supabase æŽ§åˆ¶å°æ‰‹åŠ¨æ£€æŸ¥ `badcases` è¡¨çš„ Policies

### é—®é¢˜ 4ï¼šåº”ç”¨é™çº§åˆ° localStorage

**åŽŸå› **ï¼šSupabase è¿žæŽ¥å¤±è´¥æˆ–çŽ¯å¢ƒå˜é‡ç¼ºå¤±

**æ£€æŸ¥**ï¼š
```javascript
// åœ¨æµè§ˆå™¨æŽ§åˆ¶å°è¾“å…¥
console.log(import.meta.env.VITE_SUPABASE_URL);
console.log(import.meta.env.VITE_SUPABASE_ANON_KEY);
```

å¦‚æžœè¿”å›ž `undefined`ï¼Œè¯´æ˜ŽçŽ¯å¢ƒå˜é‡æœªç”Ÿæ•ˆï¼Œéœ€è¦é‡æ–°é…ç½®ã€‚

---

## ðŸ“ æœ¬åœ°å¼€å‘é…ç½®

å¦‚æžœä½ æƒ³åœ¨æœ¬åœ°å¼€å‘æ—¶ä¹Ÿä½¿ç”¨ Supabaseï¼š

1. **åˆ›å»º .env.local æ–‡ä»¶**
   ```bash
   cd /Users/ailian/Downloads/voice-badcase-platform
   
   cat > .env.local << 'EOF'
   VITE_SUPABASE_URL=https://bpivzznuvvbafsyvzxqm.supabase.co
   VITE_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJwaXZ6em51dnZiYWZzeXZ6eHFtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzM0MDg1NjIsImV4cCI6MjA0ODk4NDU2Mn0.cXDE2rwda9N9o_eBSZeW10_YuVNCN6BCHc0kcNCuTRw
   EOF
   ```

2. **é‡å¯å¼€å‘æœåŠ¡å™¨**
   ```bash
   npm run dev
   ```

3. **éªŒè¯**
   - æ‰“å¼€ http://localhost:5173
   - æ£€æŸ¥æŽ§åˆ¶å°æ—¥å¿—

---

## âœ¨ å®Œæˆï¼

çŽ°åœ¨ä½ çš„åº”ç”¨å·²ç»ï¼š
- âœ… ä½¿ç”¨ Supabase äº‘æ•°æ®åº“
- âœ… å®žçŽ°å¤šè®¾å¤‡æ•°æ®åŒæ­¥
- âœ… åˆ é™¤æ“ä½œåœ¨æ‰€æœ‰è®¾å¤‡ç”Ÿæ•ˆ
- âœ… è‡ªåŠ¨é™çº§åˆ° localStorageï¼ˆå¦‚æžœ Supabase ä¸å¯ç”¨ï¼‰

**æµ‹è¯•æ­¥éª¤**ï¼š
1. ç”µè„‘ Aï¼šè®¿é—® https://voice-badcase-platform.vercel.app/status-flow
2. ç”µè„‘ Aï¼šåˆ é™¤ä¸€æ¡æ•°æ®
3. ç”µè„‘ Bï¼šè®¿é—®åŒä¸€ç½‘å€å¹¶åˆ·æ–°
4. âœ… æ•°æ®åº”è¯¥åŒæ­¥æ¶ˆå¤±äº†ï¼

---

## ðŸ“ž éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. Supabase æŽ§åˆ¶å°çš„è¡¨ç»“æž„
2. Vercel çš„çŽ¯å¢ƒå˜é‡é…ç½®
3. æµè§ˆå™¨æŽ§åˆ¶å°çš„é”™è¯¯æ—¥å¿—

---

**æ–‡æ¡£åˆ›å»ºæ—¶é—´**: 2024-12-22  
**ç‰ˆæœ¬**: 1.0

