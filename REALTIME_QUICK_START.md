# ğŸ”” Realtime å®æ—¶åŒæ­¥ - å¿«é€Ÿå‚è€ƒ

## é—®é¢˜
âŒ **åˆ«äººå¡«çš„ badcase æ²¡æœ‰å®æ—¶è¿›å…¥ç³»ç»Ÿ**

## è§£å†³æ–¹æ¡ˆ
âœ… **å·²å®ç° Supabase Realtime è®¢é˜…åŠŸèƒ½**

---

## ğŸš€ 5 åˆ†é’Ÿå¯ç”¨æŒ‡å—

### æ­¥éª¤ 1: å¯ç”¨ Supabase Realtime (å¿…é¡»)

```
1. æ‰“å¼€ https://app.supabase.com
2. é€‰æ‹©ä½ çš„é¡¹ç›®
3. ç‚¹å‡» Database â†’ Replication
4. æ‰¾åˆ° badcases è¡¨ï¼Œå‹¾é€‰å®ƒ
5. å®Œæˆï¼
```

**æˆ–è€…åœ¨ SQL Editor æ‰§è¡Œï¼š**
```sql
alter publication supabase_realtime add table badcases;
```

### æ­¥éª¤ 2: éªŒè¯åŠŸèƒ½

```
1. æ‰“å¼€ä¸¤ä¸ªæµè§ˆå™¨çª—å£
2. çª—å£ A: æ–°å¢ä¸€ä¸ª badcase
3. çª—å£ B: åº”è¯¥ç«‹å³æ˜¾ç¤º
4. æˆåŠŸï¼âœ…
```

---

## ğŸ§ª å¿«é€Ÿæµ‹è¯•

### æ–¹æ³• 1: æ‰“å¼€æµ‹è¯•é¡µé¢
```bash
# åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€
open test-realtime.html
```

è¾“å…¥ä½ çš„ Supabase é…ç½®åï¼Œå³å¯ç›‘æ§å®æ—¶äº‹ä»¶ã€‚

### æ–¹æ³• 2: åŒçª—å£æµ‹è¯•
```
çª—å£ A: https://voice-badcase-platform.vercel.app/
çª—å£ B: https://voice-badcase-platform.vercel.app/

åœ¨çª—å£ A æ“ä½œï¼Œè§‚å¯Ÿçª—å£ B çš„å®æ—¶æ›´æ–°
```

---

## ğŸ“Š æ•ˆæœ

| æ“ä½œ | å»¶è¿Ÿ | çŠ¶æ€ |
|------|------|------|
| æ–°å¢ | < 2 ç§’ | âœ… |
| ç¼–è¾‘ | < 2 ç§’ | âœ… |
| åˆ é™¤ | < 2 ç§’ | âœ… |

---

## ğŸ” æ•…éšœæ’æŸ¥

### æ§åˆ¶å°æ˜¾ç¤ºé”™è¯¯ï¼Ÿ

**æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å° (F12)ï¼ŒæŸ¥çœ‹æ—¥å¿—ï¼š**

âœ… **æˆåŠŸ**ï¼š
```
âœ… Realtime è®¢é˜…æˆåŠŸ
```

âŒ **å¤±è´¥**ï¼š
```
âŒ Realtime è®¢é˜…å¤±è´¥
```

**å¦‚æœå¤±è´¥**ï¼š
1. æ£€æŸ¥ Supabase è¡¨æ˜¯å¦å¯ç”¨ Realtime
2. æ£€æŸ¥ç½‘ç»œè¿æ¥
3. åˆ·æ–°é¡µé¢é‡è¯•

---

## ğŸ“š è¯¦ç»†æ–‡æ¡£

- ğŸ“– **å®Œæ•´é…ç½®æŒ‡å—**: `REALTIME_SETUP.md`
- ğŸ§ª **æµ‹è¯•è¯´æ˜**: `TEST_REALTIME.md`
- ğŸ”§ **æµ‹è¯•å·¥å…·**: `test-realtime.html`

---

## âœ… éªŒæ”¶æ ‡å‡†

å®Œæˆä»¥ä¸‹æµ‹è¯•å³è¡¨ç¤ºæˆåŠŸï¼š

- [ ] æ‰“å¼€ä¸¤ä¸ªçª—å£
- [ ] çª—å£ A æ–°å¢ â†’ çª—å£ B ç«‹å³æ˜¾ç¤º
- [ ] çª—å£ A ç¼–è¾‘ â†’ çª—å£ B ç«‹å³æ›´æ–°
- [ ] çª—å£ A åˆ é™¤ â†’ çª—å£ B ç«‹å³æ¶ˆå¤±
- [ ] æ§åˆ¶å°æ˜¾ç¤º "âœ… Realtime è®¢é˜…æˆåŠŸ"

---

## ğŸ¯ ä»£ç æ”¹åŠ¨

### æ–‡ä»¶ 1: `src/api/supabase.ts`
```typescript
// å¯ç”¨ Realtime
export const supabase = createClient(url, key, {
  realtime: {
    params: {
      eventsPerSecond: 10
    }
  }
});
```

### æ–‡ä»¶ 2: `src/contexts/BadcaseContext.tsx`
```typescript
// è®¢é˜…æ•°æ®åº“å˜åŒ–
useEffect(() => {
  const channel = supabase
    .channel('badcases-changes')
    .on('postgres_changes', {
      event: '*',
      schema: 'public',
      table: 'badcases'
    }, handleRealtimeEvent)
    .subscribe();

  return () => supabase.removeChannel(channel);
}, []);
```

---

## ğŸš¢ éƒ¨ç½²

```bash
git add .
git commit -m "feat: å®ç° Supabase Realtime å®æ—¶åŒæ­¥"
git push origin main
```

Vercel ä¼šè‡ªåŠ¨éƒ¨ç½²ï¼ˆ2-3 åˆ†é’Ÿï¼‰ã€‚

---

## ğŸ’¡ ä½¿ç”¨åœºæ™¯

âœ… **å¤šäººåä½œ**: å›¢é˜Ÿæˆå‘˜åŒæ—¶å¡«æŠ¥ï¼Œå®æ—¶çœ‹åˆ°è¿›åº¦  
âœ… **å¤§å±å±•ç¤º**: å®æ—¶å±•ç¤ºæ‰€æœ‰ badcase  
âœ… **ç§»åŠ¨ç«¯**: æ‰‹æœºå’Œç”µè„‘å®æ—¶åŒæ­¥  

---

## ğŸ†˜ éœ€è¦å¸®åŠ©ï¼Ÿ

1. æ£€æŸ¥æ§åˆ¶å°æ—¥å¿—
2. é˜…è¯» `REALTIME_SETUP.md`
3. è¿è¡Œ `test-realtime.html` è¯Šæ–­

---

**æ›´æ–°æ—¶é—´**: 2025-12-22  
**çŠ¶æ€**: âœ… å·²å®ç°å¹¶æµ‹è¯•

