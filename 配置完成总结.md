# âœ… Supabase é…ç½®å®Œæˆæ€»ç»“

## ğŸ‰ é…ç½®å·²å®Œæˆï¼

ä½ çš„è¯­éŸ³ Badcase å¹³å°å·²ç»æˆåŠŸé…ç½®ä¸ºä½¿ç”¨ Supabase äº‘æ•°æ®åº“ã€‚

---

## ğŸ“ å·²å®Œæˆçš„å·¥ä½œ

### 1. âœ… æ•°æ®åº“è¡¨åˆ›å»º

- åˆ›å»ºäº† `badcases` è¡¨ï¼ŒåŒ…å«æ‰€æœ‰å¿…è¦å­—æ®µ
- å­—æ®µä½¿ç”¨ snake_case å‘½åï¼ˆç¬¦åˆæ•°æ®åº“è§„èŒƒï¼‰
- æ·»åŠ äº†è‡ªåŠ¨æ›´æ–°æ—¶é—´æˆ³çš„è§¦å‘å™¨
- é…ç½®äº†ç´¢å¼•ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½

**ç›¸å…³æ–‡ä»¶**ï¼š
- `database/create_badcases_table.sql`
- `database/enable_public_access.sql`
- `database/check_and_fix_table.sql`

### 2. âœ… API å±‚é…ç½®

- `src/api/badcaseApi.ts` - ä¸» API æ–‡ä»¶ï¼Œå¤„ç†æ‰€æœ‰æ•°æ®åº“æ“ä½œ
- å®ç°äº†å®Œæ•´çš„å­—æ®µåæ˜ å°„ï¼ˆsnake_case â†” camelCaseï¼‰
- æ”¯æŒ CRUD æ“ä½œï¼ˆåˆ›å»ºã€è¯»å–ã€æ›´æ–°ã€åˆ é™¤ï¼‰
- å®Œå–„çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•

### 3. âœ… å®æ—¶åŒæ­¥åŠŸèƒ½

- `BadcaseContext` ä¸­é›†æˆäº† Supabase Realtime
- æ”¯æŒå¤šç”¨æˆ·å®æ—¶åä½œ
- è‡ªåŠ¨ç›‘å¬æ•°æ®å˜åŒ–ï¼ˆINSERTã€UPDATEã€DELETEï¼‰
- æœ¬åœ°çŠ¶æ€è‡ªåŠ¨åŒæ­¥

### 4. âœ… ç¯å¢ƒå˜é‡é…ç½®

- `.env.local` æ–‡ä»¶å·²é…ç½®ï¼ˆåŒ…å«åœ¨ .gitignore ä¸­ï¼‰
- Supabase URL å’Œ API Key å·²è®¾ç½®
- åº”ç”¨è‡ªåŠ¨æ£€æµ‹å¹¶ä½¿ç”¨ Supabase

### 5. âœ… ä»£ç æ¸…ç†

å·²åˆ é™¤æ—§çš„ã€ä¸å…¼å®¹çš„æ–‡ä»¶ï¼š
- âŒ `src/api/database.ts`ï¼ˆæ—§å­—æ®µç»“æ„ï¼‰
- âŒ `src/services/api.ts`ï¼ˆæ—§ API å±‚ï¼‰
- âŒ `src/components/DataVisualization.tsx`ï¼ˆä½¿ç”¨æ—§ APIï¼‰
- âŒ `src/components/BadcaseTable.tsx`ï¼ˆä½¿ç”¨æ—§ APIï¼‰
- âŒ `src/pages/DataVisualizationPage.tsx`ï¼ˆæœªä½¿ç”¨ï¼‰

### 6. âœ… æ–‡æ¡£å®Œå–„

- `SUPABASE_SETUP.md` - è¯¦ç»†é…ç½®æŒ‡å—
- `å¿«é€Ÿå¯åŠ¨.md` - 5 åˆ†é’Ÿå¿«é€Ÿä¸Šæ‰‹
- `README.md` - æ›´æ–°ä¸ºæœ€æ–°æ¶æ„
- `é…ç½®å®Œæˆæ€»ç»“.md` - æœ¬æ–‡æ¡£

---

## ğŸ—‚ï¸ æ•°æ®åº“è¡¨ç»“æ„

### badcases è¡¨

| æ•°æ®åº“å­—æ®µ | å‰ç«¯å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|-----------|---------|------|------|
| id | id | text | ä¸»é”® |
| date | date | text | æ—¥æœŸ |
| subject | subject | text | å­¦ç§‘ |
| location | location | text | ä½ç½®/ç« èŠ‚ |
| full_tts_lesson_id | fullTtsLessonId | text | å®Œæ•´ TTS è¯¾ç¨‹ ID |
| cms_id | cmsId | text | CMS ID |
| reporter | reporter | text | æŠ¥å‘Šäºº |
| category | category | text | åˆ†ç±» |
| expected_fix_date | expectedFixDate | text | é¢„æœŸä¿®å¤æ—¥æœŸ |
| status | status | text | çŠ¶æ€ |
| description | description | text | é—®é¢˜æè¿° |
| audio_url | audioUrl | text | éŸ³é¢‘ URL |
| model_id | modelId | text | æ¨¡å‹ ID |
| created_at | createdAt | timestamptz | åˆ›å»ºæ—¶é—´ï¼ˆè‡ªåŠ¨ï¼‰ |
| updated_at | updatedAt | timestamptz | æ›´æ–°æ—¶é—´ï¼ˆè‡ªåŠ¨ï¼‰ |

---

## ğŸ”§ å½“å‰é…ç½®

### Supabase è¿æ¥

```
URL: https://bpivzznuvvbafsyvzxqm.supabase.co
Key: eyJhbGciOiJI... (å·²é…ç½®)
```

### å¼€å‘æœåŠ¡å™¨

```bash
npm run dev
# è¿è¡Œåœ¨ http://localhost:3000
```

### ç”Ÿäº§æ„å»º

```bash
npm run build
# è¾“å‡ºåˆ° dist/ ç›®å½•
```

---

## ğŸ¯ ç°åœ¨å¯ä»¥åšä»€ä¹ˆ

### 1. è®¿é—®åº”ç”¨

æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼šhttp://localhost:3000

### 2. æŸ¥çœ‹åŠŸèƒ½

- **ä¸»é¡µ**ï¼šæ¦‚è§ˆå’ŒåŠŸèƒ½ä»‹ç»
- **Badcase åˆ—è¡¨**ï¼šæŸ¥çœ‹ã€æ·»åŠ ã€ç¼–è¾‘ã€åˆ é™¤ Badcase
- **çŠ¶æ€æµè½¬**ï¼šå¯è§†åŒ–é—®é¢˜å¤„ç†æµç¨‹

### 3. ä¸Šä¼ æ•°æ®

åœ¨ "Badcase åˆ—è¡¨" é¡µé¢ï¼š
1. ç‚¹å‡» "ä¸Šä¼  Excel" æŒ‰é’®
2. é€‰æ‹© Excel æ–‡ä»¶
3. æ•°æ®è‡ªåŠ¨å¯¼å…¥åˆ° Supabase

### 4. æµ‹è¯•å®æ—¶åŒæ­¥

1. æ‰“å¼€ä¸¤ä¸ªæµè§ˆå™¨çª—å£ï¼ˆæˆ–ä½¿ç”¨ä¸¤å°è®¾å¤‡ï¼‰
2. åœ¨ä¸€ä¸ªçª—å£ä¸­æ·»åŠ /ç¼–è¾‘/åˆ é™¤ Badcase
3. è§‚å¯Ÿå¦ä¸€ä¸ªçª—å£å®æ—¶æ›´æ–° âœ¨

---

## ğŸ“Š æŠ€æœ¯æ¶æ„

```
ç”¨æˆ·ç•Œé¢
    â†“
React Components
    â†“
BadcaseContext (çŠ¶æ€ç®¡ç† + Realtime)
    â†“
badcaseApi.ts (API å±‚ + å­—æ®µæ˜ å°„)
    â†“
Supabase Client
    â†“
Supabase Cloud (PostgreSQL)
```

---

## ğŸ”’ å®‰å…¨è¯´æ˜

### å½“å‰é…ç½®

- âœ… ä½¿ç”¨ `anon` public keyï¼ˆåŒ¿åè®¿é—®ï¼‰
- âœ… `.env.local` ä¸ä¼šè¢«æäº¤åˆ° Git
- âš ï¸ RLSï¼ˆè¡Œçº§å®‰å…¨ï¼‰æœªå¯ç”¨

### ç”Ÿäº§ç¯å¢ƒå»ºè®®

å¦‚éœ€æ›´é«˜å®‰å…¨æ€§ï¼š

1. **å¯ç”¨ RLS**
   ```sql
   ALTER TABLE badcases ENABLE ROW LEVEL SECURITY;
   ```

2. **åˆ›å»ºè®¿é—®ç­–ç•¥**
   ```sql
   CREATE POLICY "å…è®¸æ‰€æœ‰äººæŸ¥çœ‹" ON badcases
     FOR SELECT USING (true);
   
   CREATE POLICY "å…è®¸æ‰€æœ‰äººæ’å…¥" ON badcases
     FOR INSERT WITH CHECK (true);
   ```

3. **å¯ç”¨èº«ä»½éªŒè¯**
   - åœ¨ Supabase Dashboard é…ç½® Auth
   - æ›´æ–°å‰ç«¯æ·»åŠ ç™»å½•åŠŸèƒ½

---

## ğŸ› æ•…éšœæ’æŸ¥

### æ£€æŸ¥ Supabase è¿æ¥

æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰ï¼Œåº”è¯¥çœ‹åˆ°ï¼š

```
âœ… VITE_SUPABASE_URL: å·²è®¾ç½®
âœ… VITE_SUPABASE_ANON_KEY: å·²è®¾ç½®
âœ… Supabase å®¢æˆ·ç«¯å·²åˆå§‹åŒ–
```

### æ£€æŸ¥æ•°æ®åº“

åœ¨ Supabase Dashboardï¼š
1. è¿›å…¥ **Table Editor**
2. æŸ¥çœ‹ `badcases` è¡¨
3. ç¡®è®¤è¡¨ç»“æ„æ­£ç¡®

### æ£€æŸ¥ Realtime

åœ¨æµè§ˆå™¨æ§åˆ¶å°åº”è¯¥çœ‹åˆ°ï¼š

```
ğŸ”” æ­£åœ¨è®¢é˜… Realtime æ›´æ–°...
âœ… Realtime è®¢é˜…æˆåŠŸ
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [å¿«é€Ÿå¯åŠ¨æŒ‡å—](./å¿«é€Ÿå¯åŠ¨.md) - 5 åˆ†é’Ÿä¸Šæ‰‹
- [Supabase é…ç½®æŒ‡å—](./SUPABASE_SETUP.md) - è¯¦ç»†æ­¥éª¤
- [é¡¹ç›® README](./README.md) - é¡¹ç›®æ¦‚è§ˆ
- [Supabase å®˜æ–¹æ–‡æ¡£](https://supabase.com/docs)

---

## ğŸŠ æ­å–œï¼

ä½ çš„å¹³å°å·²ç»å®Œå…¨é…ç½®å¥½äº†ï¼ç°åœ¨å¯ä»¥ï¼š

- âœ… åœ¨äº‘ç«¯å­˜å‚¨å’Œç®¡ç† Badcase æ•°æ®
- âœ… å¤šäººå®æ—¶åä½œ
- âœ… éšæ—¶éšåœ°è®¿é—®æ•°æ®
- âœ… è‡ªåŠ¨å¤‡ä»½å’Œæ•°æ®æŒä¹…åŒ–

**å¼€å§‹ä½¿ç”¨å§ï¼** ğŸš€

---

**é…ç½®æ—¥æœŸ**ï¼š2025-12-23  
**é…ç½®äºº**ï¼šAI Assistant  
**é¡¹ç›®çŠ¶æ€**ï¼šâœ… ç”Ÿäº§å°±ç»ª

