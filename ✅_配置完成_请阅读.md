# âœ… Supabase é…ç½®å®Œæˆï¼

## ğŸ‰ å·²è‡ªåŠ¨å®Œæˆçš„é…ç½®

### âœ… 1. å®‰è£…ä¾èµ–
- å·²å®‰è£… `@supabase/supabase-js` åŒ…
- å·²æ›´æ–° `package.json`

### âœ… 2. åˆ›å»ºé…ç½®æ–‡ä»¶
- âœ… `src/api/supabase.ts` - Supabase å®¢æˆ·ç«¯
- âœ… `src/api/database.ts` - æ•°æ®åº“æ“ä½œ
- âœ… `src/services/api.ts` - API è‡ªåŠ¨åˆ‡æ¢

### âœ… 3. åˆ›å»ºç¯å¢ƒå˜é‡æ–‡ä»¶
- âœ… `.env.local` - å·²åˆ›å»ºå¹¶é…ç½®å¥½
- âœ… `.env.local.example` - æ¨¡æ¿æ–‡ä»¶

### âœ… 4. åˆ›å»ºæ•°æ®åº“è„šæœ¬
- âœ… `database/init_badcases_table.sql` - åˆå§‹åŒ–è„šæœ¬

### âœ… 5. åˆ›å»ºæ–‡æ¡£
- âœ… `SUPABASE_SETUP.md` - è¯¦ç»†é…ç½®æŒ‡å—
- âœ… `QUICK_START_SUPABASE.md` - å¿«é€Ÿå¼€å§‹

---

## ğŸš€ ç°åœ¨ä½ éœ€è¦åšçš„ï¼ˆ3 æ­¥å³å¯ï¼‰

### ç¬¬ 1 æ­¥ï¼šåˆå§‹åŒ– Supabase æ•°æ®åº“ âš¡

1. æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—® https://supabase.com
2. ç™»å½•ä½ çš„è´¦å·
3. é€‰æ‹©é¡¹ç›®ï¼ˆURL åŒ…å« `bpivzznuvvbafsyvzxqm`ï¼‰
4. ç‚¹å‡»å·¦ä¾§èœå• **SQL Editor**
5. ç‚¹å‡» **New query**
6. æ‰“å¼€é¡¹ç›®ä¸­çš„æ–‡ä»¶ `database/init_badcases_table.sql`
7. å¤åˆ¶å…¨éƒ¨å†…å®¹ï¼Œç²˜è´´åˆ° SQL Editor
8. ç‚¹å‡» **Run** æˆ–æŒ‰ `Cmd+Enter`
9. ç­‰å¾…çœ‹åˆ° "Success" æç¤º

### ç¬¬ 2 æ­¥ï¼šå¯åŠ¨é¡¹ç›® ğŸ¯

```bash
cd /Users/ailian/Downloads/voice-badcase-platform
npm run dev
```

æµè§ˆå™¨ä¼šè‡ªåŠ¨æ‰“å¼€ `http://localhost:3000`

### ç¬¬ 3 æ­¥ï¼šéªŒè¯è¿æ¥ âœ¨

æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼ˆæŒ‰ F12ï¼‰ï¼Œåº”è¯¥çœ‹åˆ°ï¼š

```
ğŸ” Supabase ç¯å¢ƒå˜é‡æ£€æŸ¥:
âœ… VITE_SUPABASE_URL: å·²è®¾ç½® (https://bpivzznuvvbafsyvzxqm.supabase.co)
âœ… VITE_SUPABASE_ANON_KEY: å·²è®¾ç½® (é•¿åº¦: 218)
âœ… Supabase å®¢æˆ·ç«¯å·²åˆå§‹åŒ–
ğŸ“ Supabase URL: https://bpivzznuvvbafsyvzxqm.supabase.co
ğŸ”§ API æ¨¡å¼: Supabase
```

å¦‚æœçœ‹åˆ°è¿™äº› âœ…ï¼Œæ­å–œï¼é…ç½®æˆåŠŸï¼

---

## ğŸ“ é¡¹ç›®æ–‡ä»¶ç»“æ„

```
voice-badcase-platform/
â”œâ”€â”€ .env.local                          âœ… ç¯å¢ƒå˜é‡ï¼ˆå·²åˆ›å»ºï¼‰
â”œâ”€â”€ .env.local.example                  âœ… ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ database/
â”‚   â””â”€â”€ init_badcases_table.sql        âœ… æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ supabase.ts                âœ… Supabase å®¢æˆ·ç«¯é…ç½®
â”‚   â”‚   â””â”€â”€ database.ts                âœ… æ•°æ®åº“æ“ä½œå‡½æ•°
â”‚   â””â”€â”€ services/
â”‚       â””â”€â”€ api.ts                     âœ… API æœåŠ¡ï¼ˆå·²æ›´æ–°ï¼‰
â”œâ”€â”€ SUPABASE_SETUP.md                   ğŸ“– è¯¦ç»†é…ç½®æŒ‡å—
â”œâ”€â”€ QUICK_START_SUPABASE.md             ğŸ“– å¿«é€Ÿå¼€å§‹æŒ‡å—
â””â”€â”€ âœ…_é…ç½®å®Œæˆ_è¯·é˜…è¯».md               ğŸ“– æœ¬æ–‡ä»¶
```

---

## ğŸ”§ ç³»ç»Ÿå·¥ä½œåŸç†

### è‡ªåŠ¨æ•°æ®æºåˆ‡æ¢

```
å‰ç«¯åº”ç”¨
    â†“
src/services/api.ts (ç»Ÿä¸€æ¥å£)
    â†“
æ£€æŸ¥ç¯å¢ƒå˜é‡
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ .env.local    â”‚  æ²¡æœ‰é…ç½®      â”‚
â”‚ å­˜åœ¨ä¸”æœ‰æ•ˆ    â”‚               â”‚
â†“               â†“               â”‚
ä½¿ç”¨ Supabase   ä½¿ç”¨ Mock æ•°æ®  â”‚
(ç”Ÿäº§ç¯å¢ƒ)       (å¼€å‘æµ‹è¯•)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ•°æ®æµç¨‹

```
ç”¨æˆ·æ“ä½œ
    â†“
BadcaseListPage ç»„ä»¶
    â†“
è°ƒç”¨ api.getBadcases()
    â†“
api.ts æ£€æµ‹ç¯å¢ƒå˜é‡
    â†“
ä½¿ç”¨ database.ts è¿æ¥ Supabase
    â†“
æŸ¥è¯¢ badcases è¡¨
    â†“
è¿”å›æ•°æ®å¹¶æ˜¾ç¤º
```

---

## ğŸ’¡ ä½¿ç”¨æç¤º

### âœ¨ æ ¸å¿ƒåŠŸèƒ½

1. **Badcase åˆ—è¡¨é¡µé¢**
   - æŸ¥çœ‹æ‰€æœ‰ Badcase
   - æœç´¢ã€ç­›é€‰ã€æ’åº
   - ä¸Šä¼  Excel æ‰¹é‡å¯¼å…¥

2. **æ•°æ®å¯è§†åŒ–é¡µé¢**
   - å®æ—¶ç»Ÿè®¡å›¾è¡¨
   - è¶‹åŠ¿åˆ†æ
   - åˆ†å¸ƒæƒ…å†µ

3. **æµè½¬çŠ¶æ€é¡µé¢**ï¼ˆStatusFlowPage.tsxï¼‰
   - æŸ¥çœ‹ Badcase æµè½¬çŠ¶æ€
   - çŠ¶æ€å˜æ›´è¿½è¸ª

### ğŸ¯ æ•°æ®æ“ä½œ

```typescript
// æŸ¥è¯¢åˆ—è¡¨
await getBadcases({ page: 1, pageSize: 20 })

// åˆ›å»º Badcase
await createBadcase({ 
  id: 'BC-001',
  problem_text: 'é—®é¢˜æè¿°',
  status: 'ä¿®å¤ä¸­',
  priority: 'P0'
})

// æ›´æ–° Badcase
await updateBadcase('BC-001', { status: 'å·²ä¸Šçº¿å¹¶éªŒè¯' })

// è·å–ç»Ÿè®¡æ•°æ®
await getStatistics()
```

---

## ğŸ”„ åˆ‡æ¢æ•°æ®æº

### ä½¿ç”¨ Supabaseï¼ˆå½“å‰é…ç½®ï¼‰

```bash
# ç¡®ä¿ .env.local æ–‡ä»¶å­˜åœ¨
ls .env.local

# å¯åŠ¨é¡¹ç›®
npm run dev
```

### åˆ‡æ¢åˆ° Mock æ•°æ®

```bash
# ä¸´æ—¶é‡å‘½åé…ç½®æ–‡ä»¶
mv .env.local .env.local.backup

# é‡å¯é¡¹ç›®
npm run dev
```

### æ¢å¤ Supabase

```bash
# æ¢å¤é…ç½®æ–‡ä»¶
mv .env.local.backup .env.local

# é‡å¯é¡¹ç›®
npm run dev
```

---

## ğŸ“Š Supabase æ•°æ®åº“è¡¨ç»“æ„

### badcases è¡¨

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| id | TEXT | ä¸»é”®ï¼ŒBadcase ID |
| problem_text | TEXT | é—®é¢˜æ–‡æœ¬ |
| audio_url | TEXT | éŸ³é¢‘ URL |
| problem_description | TEXT | é—®é¢˜æè¿° |
| detail_description | TEXT | è¯¦ç»†æè¿° |
| priority | TEXT | ä¼˜å…ˆçº§ï¼ˆP00/P0/P1/P2ï¼‰ |
| status | TEXT | çŠ¶æ€ |
| feedback_source | TEXT | åé¦ˆæ¥æº |
| feedback_date | TEXT | åé¦ˆæ—¥æœŸ |
| subject | TEXT | å­¦ç§‘ |
| model_version | TEXT | æ¨¡å‹ç‰ˆæœ¬ |
| created_at | TIMESTAMPTZ | åˆ›å»ºæ—¶é—´ |
| updated_at | TIMESTAMPTZ | æ›´æ–°æ—¶é—´ |

---

## ğŸ› æ•…éšœæ’é™¤

### é—®é¢˜ 1ï¼šç¯å¢ƒå˜é‡æœªç”Ÿæ•ˆ

**ç—‡çŠ¶**ï¼šæ§åˆ¶å°æ˜¾ç¤º "âŒ æœªè®¾ç½®"

**è§£å†³**ï¼š
```bash
# æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨
cat .env.local

# é‡å¯å¼€å‘æœåŠ¡å™¨
npm run dev
```

### é—®é¢˜ 2ï¼šæ— æ³•è¿æ¥ Supabase

**ç—‡çŠ¶**ï¼šæ§åˆ¶å°æ˜¾ç¤ºè¿æ¥å¤±è´¥

**è§£å†³**ï¼š
1. æ£€æŸ¥ URL å’Œ Key æ˜¯å¦æ­£ç¡®
2. ç¡®è®¤ Supabase é¡¹ç›®è¿è¡Œä¸­
3. æ£€æŸ¥ç½‘ç»œè¿æ¥

### é—®é¢˜ 3ï¼šè¡¨ä¸å­˜åœ¨

**ç—‡çŠ¶**ï¼šé”™è¯¯æç¤º "relation 'badcases' does not exist"

**è§£å†³**ï¼šæ‰§è¡Œç¬¬ 1 æ­¥ï¼ˆåˆå§‹åŒ–æ•°æ®åº“ï¼‰

---

## ğŸ“š æ–‡æ¡£å¿«é€Ÿé“¾æ¥

- ğŸš€ [5åˆ†é’Ÿå¿«é€Ÿå¼€å§‹](./QUICK_START_SUPABASE.md)
- ğŸ“– [å®Œæ•´é…ç½®æŒ‡å—](./SUPABASE_SETUP.md)
- ğŸ“˜ [é¡¹ç›®è¯´æ˜](./README.md)

---

## ğŸŠ ä¸‹ä¸€æ­¥

1. âœ… **åˆå§‹åŒ–æ•°æ®åº“**ï¼ˆæ‰§è¡Œ SQL è„šæœ¬ï¼‰
2. âœ… **å¯åŠ¨é¡¹ç›®**ï¼ˆ`npm run dev`ï¼‰
3. âœ… **å¼€å§‹ä½¿ç”¨**

---

## ğŸ†˜ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ï¼š
- `SUPABASE_SETUP.md` - è¯¦ç»†æ­¥éª¤
- Supabase å®˜æ–¹æ–‡æ¡£ï¼šhttps://supabase.com/docs

---

**ç¥ä½ ä½¿ç”¨æ„‰å¿«ï¼ğŸ‰**

é…ç½®æ–‡ä»¶å·²å…¨éƒ¨å°±ç»ªï¼Œåªéœ€åˆå§‹åŒ–æ•°æ®åº“å³å¯å¼€å§‹ä½¿ç”¨ï¼

